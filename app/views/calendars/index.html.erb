<%= render partial: 'common/header', locals: {sub_title: '服事安排', breadcrumb: '日历', new_path: new_calendar_path} %>

<div class="row">
  <div class="col-lg-12">
    <%= search_form_for @q, :builder => SimpleForm::FormBuilder, url: calendars_path, html: {method: :get, class: 'simple_form form-horizontal'} do |f| %>
        <%= f.input :datum_eq, :required => false, label: '按日期查找', as: :date, start_year: Time.now.year, end_year: Time.now.year + 3, order: [:year, :month, :day]  %>
        <div class="form-actions col-lg-2 col-md-3 col-sm-3 col-xs-3 lft-btn">
          <%= f.submit "查找", data: {disable_with: '正在努力查找中...'}, :class => "btn btn-primary" %>
        </div>
    <% end %>
  </div>
</div><!-- /.row -->
<div>&nbsp;</div>
<div class="row">
  <div class="col-lg-12">
    <div class="flickr_pagination">
      <%= will_paginate @contacts, :container => false %>
    </div>
    <div>&nbsp;</div>
    <table class="table table-bordered table-hover tablesorter tablesorter-default" role="grid">
      <thead>
      <tr>
        <!--td> #</td-->
        <!--td>父ID</td-->
        <!--td>左ID</td-->
        <!--td>右ID</td-->
        <!--td>深度</td-->
        <td>日期</td>
        <td>项目</td>
        <th>&nbsp;</th>
      </tr>
      </thead>
      <tbody>
      <% @calendars.each do |calendar| %>
          <tr class="<%= (calendar.datum.cweek.remainder(2)==1)?'odd':'even'%>">
            <!--td style="width:30px;min-width:30px;"> <%= calendar.id %></td-->
            <!--td style="width:45px;min-width:45px;"><%= calendar.parent_id %></td-->
            <!--td style="width:45px;min-width:45px;"><%= calendar.lft %></td-->
            <!--td style="width:45px;min-width:45px;"><%= calendar.rgt %></td-->
            <!--td style="width:45px;min-width:45px;"><%= calendar.depth %></td-->
            <td style="width:45px;min-width:45px;"><%= link_to(calendar.datum.to_s,  services_edit_calendars_path(calendar.datum.to_s,anchor: "tr_" + (calendar.id-2).to_s))%></td>
            <td style="min-width:120px;"><%= "#{'⇢' * calendar.level} #{calendar.name}".html_safe %></td>
            <!--td style="width:70px;min-width:70px;"><%= link_to('<i class="fa fa-edit"></i> 编辑'.html_safe,  services_edit_calendars_path(calendar.datum.to_s), :class => "blue")%></td-->
            <td style="width:30px;min-width:30px;"><%= link_to('<i class="fa fa-trash-o"></i>'.html_safe, services_delete_calendars_path(calendar.datum.to_s), :class => "red", :method => :delete, data: {confirm: '你确定删除这天所有的事奉安排吗？'}) %></td>
          </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div><!-- /.row -->